<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - AK Brands</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background: #f1f3f6; margin: 0; padding: 20px; }
        .checkout-container { max-width: 800px; margin: 0 auto; display: grid; grid-template-columns: 1fr; gap: 20px; }
        .item-card { background: white; padding: 20px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; border: 1px solid #e0e0e0; }
        .qty-control { display: flex; align-items: center; gap: 10px; }
        .qty-btn { background: #f1f3f6; border: 1px solid #d1d1d1; padding: 5px 12px; border-radius: 4px; cursor: pointer; font-weight: 800; }
        .summary-card { background: white; padding: 20px; border-radius: 8px; position: sticky; bottom: 20px; box-shadow: 0 -5px 15px rgba(0,0,0,0.05); }
        .total-row { display: flex; justify-content: space-between; font-size: 18px; font-weight: 800; margin-bottom: 15px; }
        .btn-order { width: 100%; background: #25d366; color: white; border: none; padding: 15px; border-radius: 8px; font-size: 16px; font-weight: 800; cursor: pointer; }
    </style>
</head>
<body>

    <h2 style="text-align:center">Your Shopping Cart</h2>
    <div id="cartItems" class="checkout-container"></div>

    <div class="summary-card">
        <div class="total-row">
            <span>Total Amount:</span>
            <span id="grandTotal">‚Çπ0</span>
        </div>
        <button class="btn-order" onclick="placeOrder()">Place Order via WhatsApp üì≤</button>
        <button onclick="window.location.href='marketplace.html'" style="width:100%; margin-top:10px; background:none; border:none; color:#007185; cursor:pointer; font-weight:700;">‚Üê Back to Marketplace</button>
    </div>

    <script>
        let cart = JSON.parse(localStorage.getItem('ak_cart')) || [];

        function renderCart() {
            const container = document.getElementById('cartItems');
            if (cart.length === 0) { container.innerHTML = "<h3>Your cart is empty</h3>"; return; }
            
            container.innerHTML = "";
            let grandTotal = 0;

            cart.forEach((item, index) => {
                const subtotal = item.price * item.qty;
                grandTotal += subtotal;
                const div = document.createElement('div');
                div.className = 'item-card';
                div.innerHTML = `
                    <div>
                        <div style="font-weight:800">${item.name}</div>
                        <div style="color:#B12704; font-weight:700">‚Çπ${item.price} / pc</div>
                    </div>
                    <div class="qty-control">
                        <button class="qty-btn" onclick="updateQty(${index}, -1)">-</button>
                        <span style="font-weight:800">${item.qty}</span>
                        <button class="qty-btn" onclick="updateQty(${index}, 1)">+</button>
                        <button onclick="removeItem(${index})" style="color:red; background:none; border:none; margin-left:10px; cursor:pointer">üóëÔ∏è</button>
                    </div>
                `;
                container.appendChild(div);
            });
            document.getElementById('grandTotal').innerText = "‚Çπ" + grandTotal.toLocaleString('en-IN');
        }

        function updateQty(index, change) {
            cart[index].qty = Math.max(cart[index].moq, cart[index].qty + change);
            localStorage.setItem('ak_cart', JSON.stringify(cart));
            renderCart();
        }

        function removeItem(index) {
            cart.splice(index, 1);
            localStorage.setItem('ak_cart', JSON.stringify(cart));
            renderCart();
        }

        function placeOrder() {
            if (cart.length === 0) return;
            let msg = `*New Bulk Order Request*\n\n`;
            cart.forEach(item => {
                msg += `üì¶ *${item.name}*\nQty: ${item.qty}\nRate: ‚Çπ${item.price}\nSubtotal: ‚Çπ${item.qty * item.price}\n\n`;
            });
            msg += `*Grand Total: ${document.getElementById('grandTotal').innerText}*\n\n*Verified B2B Enquiry from AK Brands Marketing Website*`;
            window.open(`https://api.whatsapp.com/send?phone=91XXXXXXXXXX&text=${encodeURIComponent(msg)}`, '_blank');
        }

        renderCart();
    </script>
</body>
</html>
