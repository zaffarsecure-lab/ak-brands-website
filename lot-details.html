<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AK Brands - Lot Details</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { background: #f8fafc; color: #1e293b; padding: 20px; line-height: 1.6; }
        .card { max-width: 500px; margin: 0 auto; background: white; border-radius: 20px; overflow: hidden; shadow: 0 10px 25px rgba(0,0,0,0.1); border: 1px solid #e2e8f0; }
        .header { background: #667eea; color: white; padding: 25px; text-align: center; }
        .content { padding: 25px; }
        .detail-row { display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px dashed #e2e8f0; }
        .label { font-weight: 600; color: #64748b; }
        .value { font-weight: 700; color: #1e293b; }
        .price-section { background: #f1f5f9; padding: 15px; border-radius: 12px; margin: 20px 0; text-align: center; }
        .ak-price { font-size: 28px; color: #059669; font-weight: 800; }
        .mrp { text-decoration: line-through; color: #94a3b8; font-size: 14px; }
        .btn-book { display: block; background: #25d366; color: white; text-align: center; padding: 18px; border-radius: 12px; text-decoration: none; font-weight: 700; font-size: 18px; transition: 0.3s; margin-top: 10px; }
        #loading { text-align: center; padding: 50px; font-weight: bold; color: #667eea; }
        #error-msg { display: none; text-align: center; color: #e53e3e; padding: 20px; }
    </style>
</head>
<body>

<div id="loading">üîç Fetching India's Lowest Rate...</div>
<div id="error-msg">‚ö†Ô∏è Lot not found or link expired.</div>

<div class="card" id="lot-card" style="display: none;">
    <div class="header">
        <h2 id="displayCategory">Loading...</h2>
        <p>Lot Number: <span id="displayLotNumber">---</span></p>
    </div>
    
    <div class="content">
        <div class="detail-row">
            <span class="label">üåü Condition</span>
            <span class="value" id="displayCondition">---</span>
        </div>
        <div class="detail-row">
            <span class="label">üìä Total Qty</span>
            <span class="value" id="displayQty">---</span>
        </div>
        <div class="detail-row">
            <span class="label">üì¶ Minimum Order (MOQ)</span>
            <span class="value" id="displayMoq">---</span>
        </div>

        <div class="price-section">
            <div class="mrp" id="displayMrp">MRP: --</div>
            <div class="ak-price" id="displayOffer">‚Çπ0</div>
            <div style="font-size: 12px; color: #64748b;">(India's Lowest Rate Guaranteed)</div>
        </div>

        <a href="#" id="whatsappBtn" class="btn-book">üì± Book via WhatsApp</a>
    </div>
</div>

<script>
    async function loadLotDetails() {
        const params = new URLSearchParams(window.location.search);
        const lotNum = params.get('lotNumber');
        const DB_URL = "https://ak-brands-marketing-default-rtdb.firebaseio.com/inventory.json";

        if (!lotNum) {
            showError();
            return;
        }

        try {
            const response = await fetch(DB_URL);
            const data = await response.json();
            
            // Find the specific lot by Lot Number
            const lot = Object.values(data).find(item => item.lotNumber === lotNum);

            if (lot) {
                // Fill the page with Cloud Data
                document.getElementById('displayLotNumber').innerText = lot.lotNumber;
                document.getElementById('displayCategory').innerText = lot.category;
                document.getElementById('displayCondition').innerText = lot.condition;
                document.getElementById('displayQty').innerText = lot.quantity;
                document.getElementById('displayMoq').innerText = lot.moq;
                document.getElementById('displayOffer').innerText = "‚Çπ" + lot.akOffer;
                
                if(lot.mrp) document.getElementById('displayMrp').innerText = "MRP: ‚Çπ" + lot.mrp;
                else document.getElementById('displayMrp').style.display = 'none';

                // Setup WhatsApp Booking Link
                const waMsg = encodeURIComponent(`Hi AK Brands, I want to book:\nLot No: ${lot.lotNumber}\nCategory: ${lot.category}\nRate: ${lot.akOffer}`);
                document.getElementById('whatsappBtn').href = `https://wa.me/919999999999?text=${waMsg}`; // REPLACE WITH YOUR PHONE

                // Show Card, Hide Loading
                document.getElementById('loading').style.display = 'none';
                document.getElementById('lot-card').style.display = 'block';
            } else {
                showError();
            }
        } catch (error) {
            showError();
        }
    }

    function showError() {
        document.getElementById('loading').style.display = 'none';
        document.getElementById('error-msg').style.display = 'block';
    }

    loadLotDetails();
</script>

</body>
</html>
